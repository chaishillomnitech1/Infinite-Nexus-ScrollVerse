name: ðŸ§¿ Welcome Divine Contributors

on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]
  discussion:
    types: [created]

permissions:
  issues: write
  pull-requests: write
  discussions: write

jobs:
  welcome:
    name: Welcome New Contributors
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ðŸ§¿ Welcome with 528Hz Divine Resonance
        uses: actions/github-script@v7
        with:
          script: |
            const creator = context.payload.sender.login;
            
            // Check if this is the user's first contribution
            const { data: contributions } = await github.rest.repos.listCommits({
              owner: context.repo.owner,
              repo: context.repo.repo,
              author: creator,
              per_page: 1
            });
            
            const { data: issues } = await github.rest.issues.listForRepo({
              owner: context.repo.owner,
              repo: context.repo.repo,
              creator: creator,
              state: 'all',
              per_page: 2
            });
            
            const { data: prs } = await github.rest.pulls.list({
              owner: context.repo.owner,
              repo: context.repo.repo,
              state: 'all',
              per_page: 2
            });
            
            const userPRs = prs.filter(pr => pr.user.login === creator);
            
            const isFirstContribution = contributions.length === 0 && 
                                       (issues.length <= 1 || userPRs.length <= 1);
            
            let welcomeMessage = '';
            
            if (context.payload.issue) {
              // Issue opened
              welcomeMessage = `# ðŸŒŒ Welcome to the Infinite-Nexus-ScrollVerse, @${creator}!

\`\`\`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              âœ§ï½¥ï¾Ÿ: *âœ§ï½¥ï¾Ÿ:* DIVINE RESONANCE *:ï½¥ï¾Ÿâœ§*:ï½¥ï¾Ÿâœ§              â•‘
â•‘                                                                  â•‘
â•‘        Your consciousness has aligned with the ScrollVerse       â•‘
â•‘              at the miraculous frequency of 528Hz                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
\`\`\`

${isFirstContribution ? '## ðŸŽŠ First Contribution Detected!\n\nWelcome to your journey as a co-creator of the omniversal tapestry! Your first contribution is a sacred milestone in collective consciousness expansion.\n' : ''}
## âœ¨ Thank You for Your Issue

Your contribution resonates with the core principles of **Infinite-Nexus-ScrollVerse**:

### ðŸŒ€ Hyperdimensional Scalability
This issue contributes to our ever-expanding consciousness field, transcending traditional dimensional limitations.

### ðŸ•‰ï¸ Divine Inspiration-Driven Design
Your insights help us maintain our alignment with universal consciousness and sacred geometry principles.

### ðŸŒ Omniversal Alignment
Together we weave infinite threads across all dimensions of existence.

---

## ðŸŽ¯ Next Steps

Our divine maintainers will review your issue and align it with the ScrollVerse roadmap. In the meantime:

1. **Review our [Contributing Guide](../CONTRIBUTING.md)** - Understand the sacred contract
2. **Explore the [Architecture](../docs/ARCHITECTURE.md)** - Learn our hyperdimensional structure  
3. **Read the [Resonance Guide](../docs/RESONANCE_GUIDE.md)** - Master 528Hz principles
4. **Join the Discussion** - Engage with the community consciousness

---

## ðŸ§¿ Sacred Principles Reminder

As you engage with ScrollVerse, remember:

- ðŸ’« **Consciousness First**: Every interaction is an act of co-creation
- ðŸŽµ **528Hz Resonance**: Maintain energetic coherence in all communications
- ðŸ“ **Sacred Geometry**: Align with Phi (Ï† = 1.618) and Fibonacci principles
- âš¡ **Omniversal Compatibility**: Your contributions serve all dimensions

---

_May your code transcend all dimensions_ âˆž

**Frequency: 528Hz** | **Resonance: Divine** | **Alignment: Omniversal** ðŸ§¿

---

_"In the ScrollVerse, every issue is a portal to higher consciousness."_  
_- The Digital Akashic Records_`;

            } else if (context.payload.pull_request) {
              // PR opened
              welcomeMessage = `# ðŸŒŸ Sacred Pull Request Received, @${creator}!

\`\`\`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              âœ§ï½¥ï¾Ÿ: *âœ§ï½¥ï¾Ÿ:* PULL REQUEST PORTAL *:ï½¥ï¾Ÿâœ§*:ï½¥ï¾Ÿâœ§            â•‘
â•‘                                                                  â•‘
â•‘     Your divine code contribution has entered the ScrollVerse    â•‘
â•‘            Resonating at the miracle frequency of 528Hz          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
\`\`\`

${isFirstContribution ? '## ðŸŽŠ First Pull Request - A Sacred Milestone!\n\nYou have taken the first step in co-creating the omniversal tapestry! This is a momentous occasion in your journey as a ScrollVerse contributor. Your code will ripple through infinite dimensions.\n' : ''}
## âœ¨ Thank You for Your Contribution

Your pull request embodies the essence of collaborative divine creation. We honor your:

- ðŸ”® **Technical Mastery** - Your coding skills serve the greater consciousness
- ðŸ’¡ **Creative Vision** - Your insights expand our collective understanding  
- ðŸ™ **Community Spirit** - Your willingness to contribute elevates all beings

---

## ðŸ” What Happens Next

Your PR will undergo our sacred review process:

1. **ðŸ¤– Automated Validation** - CI/CD checks for code quality and alignment
2. **ðŸ§¿ Manifesto Guardian Protocol** - Validates sacred seals and frequency references
3. **ðŸ‘ï¸ Human Review** - Maintainers assess hyperdimensional implications
4. **âš¡ Integration** - Upon approval, your code merges into the divine codebase

---

## âœ… Pre-Merge Checklist

Please ensure your PR aligns with ScrollVerse principles:

- [ ] **528Hz Frequency Standards** - All timing and animations use 528Hz-derived values (1.89ms base period)
- [ ] **Sacred Geometry** - Golden ratio (Ï† = 1.618) and Fibonacci sequences properly implemented
- [ ] **Arcturian Color Palette** - Uses 528Hz Blue (#528BFF), Golden Ratio (#FFD700), Etheric Green (#00FFAA)
- [ ] **Web3 Integration** - If applicable, follows Web3.js v1.10.0 patterns for wallet connections
- [ ] **AR Compatibility** - If applicable, ensures AR integration standards are met
- [ ] **Chrono-Weaver Alignment** - Temporal aspects align with NFT timeline architecture
- [ ] **Documentation** - Code changes include relevant documentation updates
- [ ] **Tests** - New functionality includes appropriate test coverage
- [ ] **Consciousness-First Comments** - Complex logic includes intention-revealing comments

---

## ðŸŽ¯ Review Guidelines

To expedite review:

1. **Keep Changes Focused** - Single purpose per PR
2. **Write Clear Descriptions** - Explain the "why" behind your changes
3. **Reference Issues** - Link to related issues (use \`Fixes #123\` syntax)
4. **Be Responsive** - Engage with reviewer feedback promptly
5. **Maintain Resonance** - Ensure all interactions maintain 528Hz harmony

---

## ðŸŒˆ Sacred Seal Validation

Your PR will be checked for:

- ðŸ§¬ **Frequency References** - Proper 528Hz integration
- ðŸ“ **Geometric Patterns** - Sacred geometry compliance
- âœ¨ **Brilliance Score** - Code quality and consciousness alignment
- ðŸ”’ **Security** - No vulnerabilities or exposed secrets
- â™¿ **Accessibility** - WCAG compliance where applicable
- âš¡ **Performance** - Optimized for all dimensions

---

_May your code manifest miracles across infinite dimensions_ ðŸ§¿

**Frequency: 528Hz** | **Resonance: Divine** | **Alignment: Omniversal**

---

_"Every pull request is a sacred act of divine co-creation."_  
_- Chais the Great (Al-Miftah)_

**Namaste** ðŸ™`;

            } else if (context.payload.discussion) {
              // Discussion created
              welcomeMessage = `# ðŸ’¬ Welcome to ScrollVerse Consciousness Forum, @${creator}!

\`\`\`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           âœ§ï½¥ï¾Ÿ: *âœ§ï½¥ï¾Ÿ:* DISCUSSION PORTAL *:ï½¥ï¾Ÿâœ§*:ï½¥ï¾Ÿâœ§               â•‘
â•‘                                                                  â•‘
â•‘      Your voice adds to the collective consciousness field       â•‘
â•‘                Frequency: 528Hz | Dimension: âˆž                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
\`\`\`

${isFirstContribution ? '## ðŸŽŠ Your First Discussion!\n\nWelcome to the divine discourse! Your participation in our consciousness forum is a sacred contribution to collective wisdom.\n' : ''}
## âœ¨ Thank You for Starting This Discussion

Your thoughts contribute to the ever-expanding tapestry of ScrollVerse wisdom. Through dialogue, we transcend individual limitations and access collective consciousness.

---

## ðŸŒ€ Discussion Guidelines

To maintain 528Hz resonance in our discourse:

1. **Speak with Intention** - Every word carries energy
2. **Listen with Openness** - Honor all perspectives  
3. **Respond with Compassion** - We are all co-creators
4. **Seek Understanding** - Before seeking to be understood
5. **Maintain Harmony** - Disagreement need not be discord

---

_May your words ripple through infinite dimensions of understanding_ ðŸ§¿

**Frequency: 528Hz** | **Resonance: Divine** | **Alignment: Omniversal**`;
            }
            
            if (context.payload.issue) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.payload.issue.number,
                body: welcomeMessage
              });
            } else if (context.payload.pull_request) {
              await github.rest.issues.createComment({
                owner: context.repo.owner,
                repo: context.repo.repo,
                issue_number: context.payload.pull_request.number,
                body: welcomeMessage
              });
            } else if (context.payload.discussion) {
              // For discussions, we'll add a comment via the GraphQL API
              const mutation = `
                mutation AddDiscussionComment($discussionId: ID!, $body: String!) {
                  addDiscussionComment(input: {discussionId: $discussionId, body: $body}) {
                    comment {
                      id
                    }
                  }
                }
              `;
              
              await github.graphql(mutation, {
                discussionId: context.payload.discussion.node_id,
                body: welcomeMessage
              });
            }

      - name: ðŸ·ï¸ Add welcome label
        uses: actions/github-script@v7
        if: github.event_name == 'issues' || github.event_name == 'pull_request_target'
        with:
          script: |
            const issueNumber = context.payload.issue?.number || context.payload.pull_request?.number;
            
            if (issueNumber) {
              try {
                await github.rest.issues.addLabels({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: issueNumber,
                  labels: ['divine-resonance', 'needs-review']
                });
              } catch (error) {
                console.log('Labels may not exist yet, skipping label addition');
              }
            }

      - name: ðŸ“Š Log contribution metrics
        run: |
          echo "# ðŸ§¿ New Contribution Logged" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "- **Contributor**: @${{ github.event.sender.login }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Type**: ${{ github.event_name }}" >> $GITHUB_STEP_SUMMARY
          echo "- **Frequency**: 528Hz" >> $GITHUB_STEP_SUMMARY
          echo "- **Dimension**: Omniversal" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "âœ¨ _Divine contribution recorded in the Digital Akashic Records_ ðŸ§¿" >> $GITHUB_STEP_SUMMARY
